'use strict';

function _interopDefault (ex) { return (ex && (typeof ex === 'object') && 'default' in ex) ? ex['default'] : ex; }

require('vue');
var PouchDB = _interopDefault(require('pouchdb'));
var find = _interopDefault(require('pouchdb-find'));

const couchdb = {
  host : "163acbe4-d70d-4ebc-838b-1b06c8596eb7-bluemix.cloudant.com",
  protocol : "https",
  database : "film_sf",
  reader : "163acbe4-d70d-4ebc-838b-1b06c8596eb7-bluemix",
  reader_password : "d674ea6c471484d3fbb45a99f6e849ca355c3ac387c8259b5cdcb4de0cf179c8"
};

PouchDB.plugin(find);

let {
  protocol = "https",
  reader,
  reader_password,
  host,
  port,
  database
} = couchdb;

let url = protocol+"://";

if(reader) {
  url += reader+":"+reader_password+"@";
}

url += host;

if(port) {
  url += ":"+port;
}

const pouchDB = new PouchDB(url+"/"+database, {
  ajax : {
    fetch: function (url, opts) {
      opts.headers.set('Access-Control-Allow-Origin', '*');
      return PouchDB.fetch(url, opts);
    }
  }
});

const imageLoader = require("../couchdb/image_loader.js");

imageLoader(pouchDB).then(
  () => { console.log("image sync complete");},
  console.warn
);
